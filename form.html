<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3rd LMSC Science Fest - Registration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background particles */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1.5" fill="rgba(255,255,255,0.15)"/><circle cx="40" cy="80" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="90" r="2.5" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="60" r="1.8" fill="rgba(255,255,255,0.12)"/></svg>') repeat;
            animation: float 20s infinite linear;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            100% { transform: translateY(-100vh) rotate(360deg); }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        /* Glassmorphism container */
        .glass-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .glass-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 35px 70px rgba(0, 0, 0, 0.3);
        }

        .header {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.9) 0%, rgba(124, 58, 237, 0.9) 100%);
            backdrop-filter: blur(10px);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 15px;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            position: relative;
            z-index: 2;
        }

        .form-container {
            padding: 50px;
            background: rgba(255, 255, 255, 0.05);
        }

        .form-section {
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
        }

        .form-section:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: white;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .required {
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        select,
        textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
        }

        input::placeholder,
        textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        select option {
            background: rgba(79, 70, 229, 0.9);
            color: white;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .checkbox-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .checkbox-item:hover {
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .checkbox-item:hover::before {
            left: 100%;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            accent-color: #fbbf24;
            transform: scale(1.2);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
        }

        .olympiad-participation {
            margin-bottom: 25px;
        }

        .olympiad-option {
            background: rgba(99, 102, 241, 0.15);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
        }

        .olympiad-option:hover {
            background: rgba(99, 102, 241, 0.25);
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(99, 102, 241, 0.2);
        }

        .olympiad-details {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }

        .team-participation {
            background: rgba(59, 130, 246, 0.15);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin: 25px 0;
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
        }

        .team-participation:hover {
            background: rgba(59, 130, 246, 0.25);
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.2);
        }

        .payment-info {
            background: rgba(251, 191, 36, 0.2);
            border: 2px solid rgba(251, 191, 36, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(251, 191, 36, 0.3); }
            to { box-shadow: 0 0 30px rgba(251, 191, 36, 0.5); }
        }

        .payment-info strong {
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .team-members {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .hidden {
            display: none;
        }

        .submit-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #ec4899 100%);
            color: white;
            padding: 18px 50px;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            width: 100%;
            margin-top: 40px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 50px rgba(79, 70, 229, 0.6);
            background: linear-gradient(135deg, #5b52f0 0%, #8b46f7 50%, #f056a3 100%);
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:active {
            transform: translateY(-2px) scale(0.98);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .error {
            color: #fbbf24;
            font-size: 0.9rem;
            margin-top: 8px;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .success-message {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid rgba(34, 197, 94, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            color: white;
            text-align: center;
            display: none;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Floating animation for form sections */
        .form-section {
            animation: float-section 6s ease-in-out infinite;
        }

        .form-section:nth-child(2n) {
            animation-delay: -3s;
        }

        @keyframes float-section {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .form-container {
                padding: 30px 20px;
            }

            .form-section {
                padding: 20px;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .team-members {
                grid-template-columns: 1fr;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5b52f0, #8b46f7);
        }

        /* Validation error styling */
        .validation-error {
            border-color: #fbbf24 !important;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.5) !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="glass-container">
            <div class="header">
                <h1>3rd LMSC Science Fest</h1>
                <p>Registration Portal - Join the Ultimate Academic Competition</p>
            </div>

            <div class="form-container">
                <div id="successMessage" class="success-message">
                    <h3>üéâ Registration Submitted Successfully!</h3>
                    <p>Thank you for registering! Your application has been sent to the organizers and you will receive a confirmation email shortly.</p>
                </div>

                <form action="https://api.web3forms.com/submit" id="Form" method="POST">
                    <input type="hidden" name="access_key" value="ae02ea99-49cf-4efa-b89c-33fc056a4ad3">
                    <!-- Personal Information -->
                    <div class="form-section">
                        <h2 class="section-title">Personal Information</h2>

                        <div class="form-group">
                            <label for="name">Full Name <span class="required">*</span></label>
                            <input type="text" id="name" name="name" required placeholder="Enter your full name">
                        </div>

                        <div class="form-group">
                            <label for="institution">Institution <span class="required">*</span></label>
                            <input type="text" id="institution" name="institution" required placeholder="Enter your institution name">
                        </div>

                        <div class="form-group">
                            <label for="mobile">Mobile Number <span class="required">*</span></label>
                            <input type="tel" id="mobile" name="mobile" required placeholder="Enter your mobile number">
                        </div>

                        <div class="form-group">
                            <label for="email">Gmail Address <span class="required">*</span></label>
                            <input type="email" id="email" name="email" required placeholder="Enter your Gmail address">
                        </div>

                        <div class="form-group">
                            <label for="category">Select Category <span class="required">*</span></label>
                            <select id="category" name="category" required>
                                <option value="">Choose your category</option>
                                <option value="primary">Primary (Class 3-5)</option>
                                <option value="junior">Junior (Class 6-8)</option>
                                <option value="secondary">Secondary (Class 9-10)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Olympiad Selection -->
                    <div class="form-section" id="olympiadSection" style="display: none;">
                        <h2 class="section-title">Select Olympiads <span class="required">*</span></h2>
                        <p style="margin-bottom: 20px; color: rgba(255,255,255,0.8);"><strong>MANDATORY:</strong> You must select at least one olympiad to participate in the Science Fest.</p>
                        <div class="checkbox-group" id="olympiadOptions"></div>
                        <div class="error" id="olympiadError"></div>

                        <!-- Payment section for olympiads -->
                        <div id="olympiadPaymentSection" class="hidden" style="margin-top: 30px;">
                            <div class="payment-info">
                                <strong>üí≥ Payment Required:</strong> 20 TK via bKash/Nagad to <strong>01759189875</strong> <strong>IF TRANSACTION NOT FOUND, THE REGISTRATION WILL BE CANCELLED! [TAKE A SCREENSHOT OF YOUR PAYMENT]</strong>
                            </div>

                            <div class="form-group">
                                <label for="olympiadTransaction">Transaction ID <span class="required">*</span></label>
                                <input type="text" id="olympiadTransaction" name="olympiad_transaction_id" placeholder="Enter transaction ID (REQUIRED FOR OLYMPIAD PARTICIPATION)" required>
                                <div class="error" id="olympiadTransactionError"></div>
                            </div>
                        </div>

                        <!-- Hidden field for olympiad selections -->
                        <input type="hidden" id="olympiadSelections" name="olympiad_selections" value="">
                    </div>

                    <!-- Solo Participation -->
                    <div class="form-section" id="soloSection" style="display: none;">
                        <h2 class="section-title">Solo Participation (Optional)</h2>
                        <p style="margin-bottom: 20px; color: rgba(255,255,255,0.8);">Choose individual competitions you'd like to participate in.</p>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="sudoku" name="solo_participation" value="Sudoku Challenge">
                                <label for="sudoku">Sudoku Challenge</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="chess" name="solo_participation" value="Chess Tournament">
                                <label for="chess">Chess Tournament</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="scientificPainting" name="solo_participation" value="Scientific Painting">
                                <label for="scientificPainting">Scientific Painting</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="problemSolving" name="solo_participation" value="Problem Solving">
                                <label for="problemSolving">Problem Solving</label>
                            </div>
                        </div>

                        <!-- Chess Lichess ID Section -->
                        <div id="chessLichessSection" class="hidden" style="margin-top: 30px;">
                            <div class="payment-info" style="background: rgba(59, 130, 246, 0.2); border-color: rgba(59, 130, 246, 0.4);">
                                <strong>‚ôüÔ∏è Chess Tournament Requirement:</strong> The online selection round will be held on Lichess. You must provide your Lichess ID.
                            </div>

                            <div class="form-group">
                                <label for="lichessId">Lichess ID <span class="required">*</span></label>
                                <input type="text" id="lichessId" name="lichess_id" placeholder="Enter your Lichess username (REQUIRED FOR CHESS TOURNAMENT)">
                                <div class="error" id="lichessIdError"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Team Participation -->
                    <div class="form-section" id="teamSection" style="display: none;">
                        <h2 class="section-title">Team Participation (Optional)</h2>
                        <p style="margin-bottom: 25px; color: rgba(255,255,255,0.8);">Join team competitions and showcase your collaborative skills.</p>

                        <!-- Wall Magazine -->
                        <div class="team-participation">
                            <div class="checkbox-item" style="margin-bottom: 20px;">
                                <input type="checkbox" id="wallMagazine" name="team_participation" value="Wall Magazine Competition (3 Members)">
                                <label for="wallMagazine"><strong>Wall Magazine Competition (3 Members)</strong></label>
                            </div>

                            <div id="wallMagazineDetails" class="hidden">
                                <div class="payment-info">
                                    <strong>üí≥ Payment Required:</strong> 100 TK via Bkash to <strong>01759189875</strong> <strong>IF TRANSACTION NOT FOUND, THE REGISTRATION WILL BE CANCELLED! [TAKE A SCREENSHOT OF YOUR PAYMENT]</strong>
                                </div>

                                <div class="form-group">
                                    <label for="wallMagazineTeamName">Team Name <span class="required">*</span></label>
                                    <input type="text" id="wallMagazineTeamName" name="wall_magazine_team_name" placeholder="Enter your team name">
                                </div>

                                <div class="form-group">
                                    <label for="wallMagazineTransaction">Transaction ID <span class="required">*</span></label>
                                    <input type="text" id="wallMagazineTransaction" name="wall_magazine_transaction_id" placeholder="Enter transaction ID (REQUIRED FOR WALL MAGAZINE)">
                                    <div class="error" id="wallMagazineTransactionError"></div>
                                </div>

                                <div class="team-members">
                                    <input type="text" name="wall_magazine_member_1" placeholder="Team Leader Name">
                                    <input type="text" name="wall_magazine_member_2" placeholder="Team Member 2 Name">
                                    <input type="text" name="wall_magazine_member_3" placeholder="Team Member 3 Name">
                                </div>
                            </div>
                        </div>

                        <!-- Project Showcase -->
                        <div class="team-participation">
                            <div class="checkbox-item" style="margin-bottom: 20px;">
                                <input type="checkbox" id="projectShowcase" name="team_participation" value="Project Showcase (4 Members)">
                                <label for="projectShowcase"><strong>Project Showcase (4 Members)</strong></label>
                            </div>

                            <div id="projectShowcaseDetails" class="hidden">
                                <div class="payment-info">
                                    <strong>üí≥ Payment Required:</strong> 200 TK via bKash/Nagad to <strong>01759189875</strong> <strong>IF TRANSACTION NOT FOUND, THE REGISTRATION WILL BE CANCELLED! [TAKE A SCREENSHOT OF YOUR PAYMENT]</strong>
                                </div>

                                <div class="form-group">
                                    <label for="projectShowcaseTeamName">Team Name <span class="required">*</span></label>
                                    <input type="text" id="projectShowcaseTeamName" name="project_showcase_team_name" placeholder="Enter your team name">
                                </div>

                                <div class="form-group">
                                    <label for="projectTitle">Project Title <span class="required">*</span></label>
                                    <input type="text" id="projectTitle" name="project_title" placeholder="Enter your project title">
                                </div>

                                <div class="form-group">
                                    <label for="projectBrief">Project Brief Description <span class="required">*</span></label>
                                    <textarea id="projectBrief" name="project_brief" placeholder="Write a brief description of your project..." rows="4"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="projectShowcaseTransaction">Transaction ID <span class="required">*</span></label>
                                    <input type="text" id="projectShowcaseTransaction" name="project_showcase_transaction_id" placeholder="Enter transaction ID (REQUIRED FOR PROJECT SHOWCASE)">
                                    <div class="error" id="projectShowcaseTransactionError"></div>
                                </div>

                                <div class="team-members">
                                    <input type="text" name="project_showcase_member_1" placeholder="Team Leader Name">
                                    <input type="text" name="project_showcase_member_2" placeholder="Team Member 2 Name">
                                    <input type="text" name="project_showcase_member_3" placeholder="Team Member 3 Name">
                                    <input type="text" name="project_showcase_member_4" placeholder="Team Member 4 Name">
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        Submit Registration
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        const olympiadsByCategory = {
            primary: ['Mathematics', 'Science'],
            junior: ['Mathematics', 'Science'],
            secondary: ['Mathematics', 'Physics', 'Chemistry', 'Biology', 'Astronomy']
        };

        document.getElementById('category').addEventListener('change', function() {
            const category = this.value;
            const olympiadSection = document.getElementById('olympiadSection');
            const soloSection = document.getElementById('soloSection');
            const teamSection = document.getElementById('teamSection');
            const olympiadOptions = document.getElementById('olympiadOptions');

            if (category) {
                // Show sections with animation
                olympiadSection.style.display = 'block';
                soloSection.style.display = 'block';
                teamSection.style.display = 'block';

                // Clear previous olympiad options
                olympiadOptions.innerHTML = '';

                // Add olympiad options based on category
                olympiadsByCategory[category].forEach(olympiad => {
                    const checkboxItem = document.createElement('div');
                    checkboxItem.className = 'checkbox-item';
                    checkboxItem.innerHTML = `
                        <input type="checkbox" id="${olympiad.toLowerCase()}" name="olympiads" value="${olympiad}">
                        <label for="${olympiad.toLowerCase()}">${olympiad}</label>
                    `;
                    olympiadOptions.appendChild(checkboxItem);
                });

                // Add event listeners for olympiad checkboxes
                const olympiadCheckboxes = document.querySelectorAll('input[name="olympiads"]');
                const paymentSection = document.getElementById('olympiadPaymentSection');
                const olympiadTransaction = document.getElementById('olympiadTransaction');

                olympiadCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', function() {
                        const anyChecked = document.querySelectorAll('input[name="olympiads"]:checked').length > 0;
                        if (anyChecked) {
                            paymentSection.classList.remove('hidden');
                            paymentSection.classList.add('fade-in');
                            olympiadTransaction.setAttribute('required', 'required');
                        } else {
                            paymentSection.classList.add('hidden');
                            paymentSection.classList.remove('fade-in');
                            olympiadTransaction.removeAttribute('required');
                            olympiadTransaction.value = '';
                        }
                    });
                });
            } else {
                olympiadSection.style.display = 'none';
                soloSection.style.display = 'none';
                teamSection.style.display = 'none';
            }
        });

        // Chess Tournament Handler
        document.getElementById('chess').addEventListener('change', function() {
            const lichessSection = document.getElementById('chessLichessSection');
            const lichessInput = document.getElementById('lichessId');
            if (this.checked) {
                lichessSection.classList.remove('hidden');
                lichessSection.classList.add('fade-in');
                lichessInput.setAttribute('required', 'required');
            } else {
                lichessSection.classList.add('hidden');
                lichessSection.classList.remove('fade-in');
                lichessInput.removeAttribute('required');
                lichessInput.value = '';
            }
        });

        // Team participation handlers
        document.getElementById('wallMagazine').addEventListener('change', function() {
            const details = document.getElementById('wallMagazineDetails');
            const transactionInput = document.getElementById('wallMagazineTransaction');
            const teamNameInput = document.getElementById('wallMagazineTeamName');
            if (this.checked) {
                details.classList.remove('hidden');
                details.classList.add('fade-in');
                transactionInput.setAttribute('required', 'required');
                teamNameInput.setAttribute('required', 'required');
            } else {
                details.classList.add('hidden');
                details.classList.remove('fade-in');
                transactionInput.removeAttribute('required');
                teamNameInput.removeAttribute('required');
                // Clear form fields
                details.querySelectorAll('input').forEach(input => input.value = '');
            }
        });

        document.getElementById('projectShowcase').addEventListener('change', function() {
            const details = document.getElementById('projectShowcaseDetails');
            const transactionInput = document.getElementById('projectShowcaseTransaction');
            const teamNameInput = document.getElementById('projectShowcaseTeamName');
            const projectTitleInput = document.getElementById('projectTitle');
            const projectBriefInput = document.getElementById('projectBrief');
            if (this.checked) {
                details.classList.remove('hidden');
                details.classList.add('fade-in');
                transactionInput.setAttribute('required', 'required');
                teamNameInput.setAttribute('required', 'required');
                projectTitleInput.setAttribute('required', 'required');
                projectBriefInput.setAttribute('required', 'required');
            } else {
                details.classList.add('hidden');
                details.classList.remove('fade-in');
                transactionInput.removeAttribute('required');
                teamNameInput.removeAttribute('required');
                projectTitleInput.removeAttribute('required');
                projectBriefInput.removeAttribute('required');
                // Clear form fields
                details.querySelectorAll('input, textarea').forEach(input => input.value = '');
            }
        });

        // Form submission with enhanced validation
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // Clear previous error states
            document.querySelectorAll('.validation-error').forEach(el => el.classList.remove('validation-error'));
            document.querySelectorAll('.error').forEach(el => el.textContent = '');

            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Submitting... <span class="loading"></span>';

            // Validate required fields
            const requiredFields = ['name', 'institution', 'mobile', 'email', 'category'];
            let isValid = true;
            let errorMessage = '';

            requiredFields.forEach(field => {
                const input = document.getElementById(field);
                if (!input.value.trim()) {
                    isValid = false;
                    input.classList.add('validation-error');
                    errorMessage += `‚Ä¢ ${input.previousElementSibling.textContent.replace(' *', '')} is required\n`;
                }
            });

            // Validate olympiad selection and REQUIRED payment
            const olympiadCheckboxes = document.querySelectorAll('input[name="olympiads"]:checked');
            const olympiadError = document.getElementById('olympiadError');
            const olympiadTransactionError = document.getElementById('olympiadTransactionError');

            // MANDATORY: At least one olympiad must be selected
            if (olympiadCheckboxes.length === 0) {
                isValid = false;
                olympiadError.textContent = 'REQUIRED: You must select at least one olympiad to participate in the Science Fest.';
                errorMessage += '‚Ä¢ At least one olympiad is MANDATORY for participation\n';
            } else if (olympiadCheckboxes.length > 0) {
                // CRITICAL: Validate transaction ID for olympiad participation
                const transactionInput = document.getElementById('olympiadTransaction');
                if (!transactionInput.value.trim()) {
                    isValid = false;
                    transactionInput.classList.add('validation-error');
                    olympiadTransactionError.textContent = 'Transaction ID is required for olympiad participation';
                    errorMessage += '‚Ä¢ Transaction ID is required for olympiad participation\n';
                }

                // Update hidden field with selected olympiads
                const selectedOlympiads = Array.from(olympiadCheckboxes).map(cb => cb.value);
                document.getElementById('olympiadSelections').value = selectedOlympiads.join(', ');
            }

            // Validate Chess Lichess ID
            const chessChecked = document.getElementById('chess').checked;
            const lichessIdError = document.getElementById('lichessIdError');
            if (chessChecked) {
                const lichessInput = document.getElementById('lichessId');
                if (!lichessInput.value.trim()) {
                    isValid = false;
                    lichessInput.classList.add('validation-error');
                    lichessIdError.textContent = 'Lichess ID is required for Chess Tournament participation';
                    errorMessage += '‚Ä¢ Lichess ID is required for Chess Tournament participation\n';
                }
            }

            // Validate team participation REQUIRED payments and fields
            const wallMagazineChecked = document.getElementById('wallMagazine').checked;
            const projectShowcaseChecked = document.getElementById('projectShowcase').checked;
            const wallMagazineTransactionError = document.getElementById('wallMagazineTransactionError');
            const projectShowcaseTransactionError = document.getElementById('projectShowcaseTransactionError');

            if (wallMagazineChecked) {
                const transactionInput = document.getElementById('wallMagazineTransaction');
                const teamNameInput = document.getElementById('wallMagazineTeamName');
                if (!transactionInput.value.trim()) {
                    isValid = false;
                    transactionInput.classList.add('validation-error');
                    wallMagazineTransactionError.textContent = 'Transaction ID is required for Wall Magazine participation';
                    errorMessage += '‚Ä¢ Transaction ID is required for Wall Magazine participation\n';
                }
                if (!teamNameInput.value.trim()) {
                    isValid = false;
                    teamNameInput.classList.add('validation-error');
                    errorMessage += '‚Ä¢ Team Name is required for Wall Magazine participation\n';
                }
            }

            if (projectShowcaseChecked) {
                const transactionInput = document.getElementById('projectShowcaseTransaction');
                const teamNameInput = document.getElementById('projectShowcaseTeamName');
                const projectTitleInput = document.getElementById('projectTitle');
                const projectBriefInput = document.getElementById('projectBrief');

                if (!transactionInput.value.trim()) {
                    isValid = false;
                    transactionInput.classList.add('validation-error');
                    projectShowcaseTransactionError.textContent = 'Transaction ID is required for Project Showcase participation';
                    errorMessage += '‚Ä¢ Transaction ID is required for Project Showcase participation\n';
                }
                if (!teamNameInput.value.trim()) {
                    isValid = false;
                    teamNameInput.classList.add('validation-error');
                    errorMessage += '‚Ä¢ Team Name is required for Project Showcase participation\n';
                }
                if (!projectTitleInput.value.trim()) {
                    isValid = false;
                    projectTitleInput.classList.add('validation-error');
                    errorMessage += '‚Ä¢ Project Title is required for Project Showcase participation\n';
                }
                if (!projectBriefInput.value.trim()) {
                    isValid = false;
                    projectBriefInput.classList.add('validation-error');
                    errorMessage += '‚Ä¢ Project Brief is required for Project Showcase participation\n';
                }
            }

            if (!isValid) {
                // Reset button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Submit Registration';

                // Show detailed error message
                alert('‚ùå SUBMISSION FAILED - Missing Required Information:\n\n' + errorMessage + '\n‚ö†Ô∏è ALL TRANSACTION IDs AND TEAM INFORMATION ARE MANDATORY FOR SELECTED EVENTS!\n\nPlease fill in all required fields and transaction IDs before submitting.');

                // Scroll to first error
                const firstError = document.querySelector('.validation-error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    firstError.focus();
                }
                return;
            }

            // Submit the form
            const formData = new FormData(this);

            // Try multiple email services for better delivery
            Promise.all([
                // Method 1: Formspree
                fetch('https://formspree.io/f/xqaklkdy', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: 'sahadakhatun1977@gmail.com',
                        subject: 'üéì 3rd LMSC Science Fest - New Registration',
                        name: formData.get('name'),
                        institution: formData.get('institution'),
                        mobile: formData.get('mobile'),
                        participant_email: formData.get('email'),
                        category: formData.get('category'),
                        olympiad_selections: formData.get('olympiad_selections'),
                        solo_participation: Array.from(document.querySelectorAll('input[name="solo_participation"]:checked')).map(cb => cb.value).join(', '),
                        lichess_id: formData.get('lichess_id'),
                        team_participation: Array.from(document.querySelectorAll('input[name="team_participation"]:checked')).map(cb => cb.value).join(', '),
                        wall_magazine_team_name: formData.get('wall_magazine_team_name'),
                        wall_magazine_transaction: formData.get('wall_magazine_transaction_id'),
                        project_showcase_team_name: formData.get('project_showcase_team_name'),
                        project_title: formData.get('project_title'),
                        project_brief: formData.get('project_brief'),
                        project_showcase_transaction: formData.get('project_showcase_transaction_id'),
                        // Add olympiad transaction ID
                        olympiad_transaction: formData.get('olympiad_transaction_id'),
                        submission_time: new Date().toLocaleString(),
                        _replyto: formData.get('email')
                    })
                }).catch(() => null)
            ])
            .then(responses => {
                // Check if at least one method succeeded
                const hasSuccess = responses.some(response => response && response.ok);

                if (hasSuccess) {
                    // Show success message
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('registrationForm').style.display = 'none';

                    // Scroll to success message
                    document.getElementById('successMessage').scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                } else {
                    throw new Error('All email methods failed');
                }
            })
            .catch(error => {
                console.error('Error:', error);

                // Fallback: Create mailto link for manual sending
                let emailBody = 'üìù NEW REGISTRATION - 3rd LMSC Science Fest\n\n';
                emailBody += `Name: ${formData.get('name')}\n`;
                emailBody += `Institution: ${formData.get('institution')}\n`;
                emailBody += `Mobile: ${formData.get('mobile')}\n`;
                emailBody += `Email: ${formData.get('email')}\n`;
                emailBody += `Category: ${formData.get('category')}\n`;
                emailBody += `Olympiads: ${formData.get('olympiad_selections')}\n`;

                // Add transaction ID for olympiad participation
                if (formData.get('olympiad_transaction_id')) {
                    emailBody += `Olympiad Transaction: ${formData.get('olympiad_transaction_id')}\n`;
                }

                const soloEvents = Array.from(document.querySelectorAll('input[name="solo_participation"]:checked')).map(cb => cb.value);
                if (soloEvents.length > 0) {
                    emailBody += `Solo Events: ${soloEvents.join(', ')}\n`;
                    if (formData.get('lichess_id')) {
                        emailBody += `Lichess ID: ${formData.get('lichess_id')}\n`;
                    }
                }

                const teamEvents = Array.from(document.querySelectorAll('input[name="team_participation"]:checked')).map(cb => cb.value);
                if (teamEvents.length > 0) {
                    emailBody += `Team Events: ${teamEvents.join(', ')}\n`;
                    if (formData.get('wall_magazine_transaction_id')) {
                        emailBody += `Wall Magazine Team: ${formData.get('wall_magazine_team_name')}\n`;
                        emailBody += `Wall Magazine Transaction: ${formData.get('wall_magazine_transaction_id')}\n`;
                        emailBody += `Wall Magazine Members: ${formData.get('wall_magazine_member_1') || ''}, ${formData.get('wall_magazine_member_2') || ''}, ${formData.get('wall_magazine_member_3') || ''}\n`;
                    }
                    if (formData.get('project_showcase_transaction_id')) {
                        emailBody += `Project Showcase Team: ${formData.get('project_showcase_team_name')}\n`;
                        emailBody += `Project Title: ${formData.get('project_title')}\n`;
                        emailBody += `Project Brief: ${formData.get('project_brief')}\n`;
                        emailBody += `Project Showcase Transaction: ${formData.get('project_showcase_transaction_id')}\n`;
                        emailBody += `Project Showcase Members: ${formData.get('project_showcase_member_1') || ''}, ${formData.get('project_showcase_member_2') || ''}, ${formData.get('project_showcase_member_3') || ''}, ${formData.get('project_showcase_member_4') || ''}\n`;
                    }
                }

                emailBody += `\nSubmitted on: ${new Date().toLocaleString()}`;

                const mailtoLink = `mailto:sahadakhatun1977@gmail.com?subject=${encodeURIComponent('üéì LMSC Science Fest Registration - ' + formData.get('name'))}&body=${encodeURIComponent(emailBody)}`;

                // Open email client
                window.open(mailtoLink);

                alert('üìß Your email client will open with the registration details. Please send the email to complete your registration. If no email client opens, please manually send the registration details to sahadakhatun1977@gmail.com');

                // Show success message anyway
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('registrationForm').style.display = 'none';
                document.getElementById('successMessage').scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            })
            .finally(() => {
                // Reset button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Submit Registration';
            });
        });

        // Add smooth scroll behavior
        document.documentElement.style.scrollBehavior = 'smooth';

        // Real-time validation feedback
        function addRealTimeValidation(inputId, errorId) {
            const input = document.getElementById(inputId);
            const errorDiv = document.getElementById(errorId);

            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.classList.remove('validation-error');
                    if (errorDiv) errorDiv.textContent = '';
                }
            });
        }

        // Add real-time validation for transaction fields
        addRealTimeValidation('olympiadTransaction', 'olympiadTransactionError');
        addRealTimeValidation('wallMagazineTransaction', 'wallMagazineTransactionError');
        addRealTimeValidation('projectShowcaseTransaction', 'projectShowcaseTransactionError');
        addRealTimeValidation('lichessId', 'lichessIdError');
    </script>
</body>
</html>
